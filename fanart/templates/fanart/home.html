{% extends "fanart/base.html" %}
{% load bbcode_tags %}

{% block activetab_home %}active{% endblock %}

{% block grass %}
{% include "fanart/grass_home.html" %}
{% endblock %}

{% block body_prop %}{% endblock %}

{% block content %}

<div class="frontpagebanners">

    <div class="banner-block" id="adminannouncements">
        <h3>Admin Announcements</h3>
        <div id="adminannouncements_inner" class="bulletinsinner bulletinsscroll">
        {% include "includes/admin_announcements.html" %}
        </div>
        <div id="adminannouncementsmore">
        <button class="small" onClick="getMoreAdminAnnouncements(adminannouncementsshown,10)">More</button>
        </div>
    </div>

    <div class="banner-block" id="bulletins">
        <h3>Bulletins</h3>
        <div id="bulletins_inner" class="bulletinsinner bulletinsstatic">
        {% include "includes/bulletins.html" %}
        </div>
        <div id="bulletinsmore">
        <button class="small" onClick="getMoreBulletins(bulletinsshown,10)">More</button>
        </div>
    </div>

    {% if current_contest %}
    <div class="banner-block current-contest">
        <h3>Current Art Contest</h3>
        <p class="contest-title"><a href="{% url "contest" contest_id=current_contest.id %}">{{ current_contest.title }}</a></p>
	<div class="contest-theme">
                {{ current_contest.description|bbcode|safe }}
	</div>
        <p>{{ current_contest.contestentry_set.count }} entr{{ current_contest.contestentry_set.count|pluralize:"y,ies" }}</p>
        {% if current_contest.is_ended %}
            Winner: {{ current_contest.get_winner.picture.artist.username }}
        {% else %}
            <p><b>({{ current_contest.days_left }} day{{ current_contest.days_left|pluralize }} left)</b></p>
        {% endif %}
    </div>
    {% endif %}

    <div class="banner-block" id="upcoming_birthdays">
        <h3>Upcoming Birthdays</h3>
        <div class="birthdays-scroll">
        {% for birthday in upcoming_birthdays %}
            <div class="upcoming-birthday">
                <p class="float-right">{{ birthday.next_birthday|date:"M j" }}</p>
                <p><a href="{% url "artist" dir_name=birthday.dir_name %}">{{ birthday.username }}</a>
                {% if birthday.show_birthdate_age %}
                    <span class="birthday-age">{{ birthday.age }}</span>
                {% endif %}
                </p>
            </div>
        {% endfor %}
        </div>
    </div>

</div>

<div class="random-popular">
{% include "includes/random_popular.html" %}
</div>

<div class="group">
<div class="featurebox front-page">

{% for artist in recently_active_artists %}

    {% for picture in artist.recently_uploaded_pictures %}

        {% if forloop.counter == 1 %}

            {% include "includes/picture.html" %}

        {% else %}

            {% if forloop.counter == 2 %}
                <div class="also-today group masonry">
            {% endif %}

            <div class="offertile picturetile">
                <a id="picturetile_{{ picture.id }}" class="previewPopupTrigger" type="picture" itemid="{{ picture.id }}" href="{% url "picture" picture_id=picture.id %}"><img src="{{ picture.thumbnail_url }}" width="60" height="{{ picture.thumb_height }}" /></a>
                {{ picture.date_uploaded|date }}
            </div>

            {% if forloop.counter == artist.recently_uploaded_pictures|length %}
                </div>
            {% endif %}

        {% endif %}

    {% endfor %}

{% endfor %}

<a class="button" href="{% url "artwork" list="newest" %}">More Recent Artwork</a>

</div>
</div>

<div class="featurebox">


{% comment %}
<div class="birthday clearAfter">
	<sql:query var="qryBdayToday">
	SELECT *,
	YEAR(birthdate) AS bdyear,
	DATEDIFF(DATE_ADD(NOW(),INTERVAL 180 DAY),birthdate) as daysdiff
	FROM artists
	WHERE MONTH(birthdate)=MONTH(NOW())
	AND DAY(birthdate)=DAY(NOW())
	AND active=true
	AND enabled=true
	AND numpictures>0
	AND showbirthdate=true
	ORDER BY artistname
	</sql:query>

	<c:if test="${qryBdayToday.rowCount > 0}">
	<div>Happy birthday to:</div>
	<table>
	<c:forEach var="bdartist" items="${qryBdayToday.rows}">
		<tr>
		<td><a href="/Artists/${bdartist.dirname}/">${bdartist.artistname}</a></td>
		<td><c:if test="${bdartist.showbirthdate_age == true && bdartist.bdyear > 0}"><fmt:formatNumber value="${bdartist.daysdiff / 365}" type="number" pattern="###" /></c:if></td>
		</tr>
	</c:forEach>
	</table>
	</c:if>
	<div class="birthdaylink"><a href="pop_birthdays.jsp" rel="shadowbox;width=500;height=600">Upcoming Birthdays</a></div>
<br clear="all" />
</div>
{% endcomment %}

{% include "includes/aotm.html" %}

</div>

{% endblock %}

<jsp:include page="inc_root/inc_lowerlayout.jsp" />
<jsp:include page="inc_root/inc_footer.jsp" />

